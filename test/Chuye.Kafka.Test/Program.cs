using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Threading;
using System.Threading.Tasks;
using Chuye.Kafka.Internal;
using Chuye.Kafka.Protocol;

namespace Chuye.Kafka.Test {
    public class Program {
        static Option option;

        static void Main(string[] args) {
            Debug.Listeners.Add(new TextWriterTraceListener(Console.Out));
            option = new Option(new Uri("http://ubuntu-16:9094"), new Uri("http://ubuntu-16:9093"));
            option.GetSharedClient().RequestSending += (_, e) => {
                //e.Uri = new Uri(e.Uri.AbsoluteUri.Replace("ubuntu-16", "localhost"));
            };

            DeserializeFrom();
            //SendMessage();
            //StartConsumeAndBlock();
        }

        private static void StartConsumeReadLine() {
            var cts = new CancellationTokenSource();
            StartConsume(cts.Token);
            Console.WriteLine("Press <ENTER> to exit");
            Console.ReadLine();
            cts.Cancel();
        }

        static void DeserializeFrom() {
            var bf = "[00 00 19 A8 00 00 00 10 00 00 00 01 ][00 0A 64 65 6D 6F 54 6F 70 69 63 33 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 C8 00 00 19 7E 00 00 00 00 00 00 00 C7 00 00 19 72 F3 B6 0F 37 00 01 FF FF FF FF 00 00 19 64 1F 8B 08 00 00 00 00 00 00 00 55 5A 09 F8 AF 63 99 3E 95 72 2C 4D B6 E1 24 B2 FC 8E 2D 26 EF BE 58 0A 75 2A CA EE A4 8D BC 6B C5 39 44 59 8B 44 23 4B 0A 21 84 12 66 C8 D2 14 46 43 93 ED D0 84 31 49 A6 C8 72 4D 0A 59 A7 24 2E 34 E6 7E 7E 9D EF F7 3D 9D AE 9C 72 FD EF FF F7 7E EF 7B 3F F7 73 DF EF F3 CD 99 33 FB 23 4F 3D E7 F2 35 E7 CC 79 15 7F F0 FF 26 CA 85 68 B4 76 2A 45 6F 4C 55 A1 0A DF 4D D2 AA 6B 6F BD 68 13 2B 96 02 5F 43 E0 5D 56 BC 72 09 03 47 17 F0 93 CD 4A 9B 4C 95 3A 89 62 5B 51 2D 37 A9 54 71 7D 62 E5 52 F0 6B 09 FC E8 92 33 9F 1C C1 46 E8 D8 95 30 D5 2B 69 74 30 D9 69 E3 8B 31 D1 58 8D 05 C4 89 55 4B C1 AF 23 F0 CD 2B AF FF 32 07 DB 96 83 77 5D E6 6A 9A EC 49 46 29 B1 7A 91 BD 0C 3D DA 89 D5 4B C1 CB 10 F8 CF 0B DB D7 46 B0 ED 42 54 AC AF B5 20 8C D1 32 E6 50 5A F4 42 E6 22 53 4F 78 67 B3 14 FC 7A 02 9F F3 D8 FD AB 8C 60 11 94 B5 2D 66 D5 B3 35 AA D7 A8 7A A8 D6 6A 61 BA D0 BD E1 9D ED 52 F0 1B 08 BC D5 CD 5F 3C 7A 04 3B BC 9D 6C 78 D1 8E 5D B7 3E E4 DA B2 F0 21 26 E3 AA 28 45 4C AC 5B 0A 5E 96 C0 9B FF FE 91 D3 46 70 2E 26 F5 22 65 2A A2 18 1F 4A F2 41 5B 5F 44 CF 4A D6 D4 B0 61 7E 29 78 2E 81 B7 3B 62 72 C7 08 EE AE 69 6D 4D 6D A1 61 8B 53 C6 39 BB E4 4A F0 C6 B9 AC 2B C0 61 29 78 39 02 7F 22 7E F6 EB 6C C3 62 6A D8 A6 A6 0C 76 DB 85 90 82 F6 CD 88 6C B1 0E 67 BC C2 0F 2C 05 2F 4F E0 25 DF B9 FA 13 23 B8 6A 9F 75 93 B2 29 D7 71 C0 05 0B D0 2E F6 56 84 D7 A2 86 38 71 03 C3 56 20 F0 77 DF B3 C9 49 23 38 76 50 AA 36 DD 75 2A 06 90 2C A3 55 3A 25 AD 89 37 DE 4F DC C0 B0 15 09 DC D7 98 BB 39 A3 27 E1 64 B1 C2 09 05 52 75 6C B5 F4 DE 54 57 A3 2D 39 D5 89 1B 18 F6 C6 E9 6E BF 6E E5 AB 19 C3 52 C3 F6 9A DC 6D 0B 26 36 93 A2 D0 39 79 E9 AC 2B 5A 2A 37 71 03 C3 FE 8E C0 3F DF 6B EE 4D 23 38 84 96 8D 92 DA 85 AA 8D F2 2A 07 AC D5 C6 2E A5 A8 A6 78 BC F3 C0 B0 37 11 78 83 A7 56 3C 8B ED 76 EE 0E 40 A7 C0 46 93 9C CE B9 C5 2A 4C 2A 32 76 2D 7A 9B B8 81 61 2B 11 F8 CE 57 17 5F 30 82 A5 08 C2 76 6B C1 08 6D A4 C9 B1 A3 42 6B CF 5D D4 24 5B 94 13 37 30 6C E5 29 3D FF 63 0F 76 54 45 75 6B 9A 08 56 A9 80 BF 6D AE DA 59 ED 6B C8 E0 0E B6 72 E2 06 86 AD 32 05 BF F0 F4 17 D8 86 55 5B 6A 08 25 40 10 0C 58 95 84 08 25 8B 1E 92 68 5E 27 35 71 03 C3 56 25 F0 9C 1D 9F 38 8F 55 95 12 4D 96 04 B4 95 46 0A 1D B0 01 B2 62 ED B1 D4 56 92 99 B8 81 61 AB 11 F8 88 F3 6E 62 55 D5 8A 8B 58 B0 D5 B2 35 E3 4D 24 A2 36 15 B1 7C 81 7F DF DA C4 0F 0C FB 7B 02 DF 7E EF B7 4F 1D C1 C9 18 05 41 70 60 93 34 4E E9 6C BA D4 31 CB 9A BB E9 56 E6 89 1F 18 B6 3A 81 DF B8 D2 EA 6F 62 0C CB B2 E9 E8 52 34 AD 9B 46 3B 67 83 F5 C6 4A 19 F0 2F 43 9D F8 81 61 6B 10 78 CB EB D2 D3 6C C3 72 B2 19 42 16 55 4B 26 74 0F 66 5B 81 DA F2 22 82 3B 56 4F FC C0 B0 79 04 7E E2 02 ED 39 C3 94 8A DD 25 65 F1 E6 3E C6 AC 95 6D 36 E1 95 51 99 A8 8D 89 1F 18 F6 66 02 EF B3 C1 B9 87 B1 73 96 C4 6B 94 14 36 C7 84 A6 82 97 16 94 55 31 06 A9 65 C6 93 07 86 AD 49 E0 BB 8F 5D E7 DA 11 EC 6D AA 15 6A 85 9D 32 A6 74 D0 CA C7 86 17 6F 90 21 9F 5D 99 F8 81 61 6F 21 F0 4D 3F BD FB 17 EC A8 4C C5 EE 24 3C 0E EA 09 11 83 DC 86 EC 84 50 B5 40 4B AC 98 F8 81 61 6B 4D 97 FD BB 7A 03 13 40 D1 6A F2 D5 07 E1 A3 71 39 C7 DC 7C 24 CA 94 D4 F0 5B CD C4 0F 0C 5B 9B C0 87 9E 36 6F 25 56 18 1E 6A 20 A3 AF CE 56 A3 BD 4F C9 B7 D4 A3 C6 06 A4 52 7A 9A F8 81 61 6F 25 B0 5A E9 B8 77 B1 92 D4 29 F7 A6 ED B4 57 55 EF 63 EF 55 C8 88 7A 4C BD E3 75 26 61 60 D8 3A 04 DE 6C FF EB 37 60 02 58 50 C8 AD AB 90 5C 9B B6 58 17 5C 2E 4D 34 F4 0F EB 94 99 84 81 61 EB 12 D8 5F B8 88 6D 98 74 25 36 54 16 34 28 18 11 E8 1F 12 2B 57 CA B7 96 1D 36 2C 0C 0C 5B 8F C0 8F 9F 74 CF 7D 4C F4 51 3E BA A2 18 45 74 26 0B 1C 7A 09 B2 67 B4 39 C8 92 16 65 12 06 86 AD 4F E0 97 9F D9 F0 B5 8C DB 3A 88 E4 AC 09 5A 77 93 4B 8E 31 A1 51 C9 1A 2B DA BC 6E 76 12 06 86 4D 08 6C BF BF DC F6 EC C9 86 64 40 95 98 34 6C 85 4F 59 16 0F 45 88 CE 79 F4 1D 88 7E 18 18 36 7F 7A 54 73 0E 3B 99 ED B6 D2 9A 36 DC 25 52 30 98 01 88 A0 B1 B9 78 13 64 68 A5 4D C2 C0 B0 0D 08 7C DB 37 4E BF 9B ED 76 06 AC BA D2 3D 11 AC C9 18 9A CE 5D DB 18 BD 82 AC E5 49 18 18 B6 21 81 EF 7D F4 E6 C8 AB AA 27 D3 63 52 E4 0C AA 50 09 AD B1 24 A5 F1 1A 4E 47 91 F0 03 4B C1 1B 11 F8 D5 F5 4F 3D 9E 81 9D C7 E9 58 6B 23 DC 90 45 87 41 7B D4 60 66 6A CA 0B 58 8E 49 18 18 B6 31 81 3F F2 7F 17 3F C2 C0 15 0A EB 55 97 A0 93 E9 CA 66 15 75 B6 E8 D0 5D E1 AC A4 9D C4 81 61 9B 10 F8 4B FF FB 93 F5 47 B0 16 A2 09 D1 A1 3C 45 19 13 6A 4C 16 3B 17 83 02 4F 6A 82 A1 89 03 C3 DE 36 25 49 DC EE 00 06 86 40 5B B4 64 90 05 87 6D 65 AC 78 6D 9F E1 E4 B0 D5 BA C8 49 1C 18 B6 29 81 17 7F 77 BD 3D 19 49 D0 5A 3C E4 20 E1 29 68 6C 06 92 94 C1 98 22 4B 0C 10 D0 32 89 03 C3 36 23 F0 FC 57 4E 5E 81 89 3E 6A 12 FA E5 53 B4 1D 75 01 F5 81 84 69 2D 1A CC 46 53 A2 4F E2 C0 B0 7F 20 F0 43 7B 6F B9 16 DB 30 90 02 15 1C 3D 7E 16 CA D1 B3 0C 56 C3 C7 C1 18 FA 5C 5D 98 C4 81 61 6F 27 F0 03 9F 2B 8A 89 BE 80 F1 C9 26 41 F1 B3 41 5F 8E 31 2A 11 2A 09 A2 72 22 61 B7 07 86 6D 4E E0 DF 3D F5 F1 4B 98 89 D3 B6 38 EC 0E 1C 01 59 E6 9C 5A F5 68 41 DE C0 63 19 F0 66 12 07 86 D1 91 C9 95 2E F9 FE FF B0 DD D6 1A 27 9D 02 DE D6 1B D1 15 D5 52 76 D1 59 52 40 B4 82 49 1C 18 46 47 26 1F DC E5 0D 9F 64 BB 2D E0 B4 BD 57 B1 46 89 0E 87 A6 EA A0 5D F0 19 0A C2 68 24 36 6C 60 18 1D 99 DA 7A 77 75 E5 0C 3C 1F FE 58 60 E9 D9 66 41 36 14 AB 87 38 38 68 37 FD 0A 34 8F 89 9C 59 7D 3A 33 F5 A9 25 67 8E DB 3D 5F 77 2B 2C 7E BE D8 0C DD 4F 10 7B E2 59 A0 C6 5B 4B 14 12 E8 81 63 74 68 EA 43 EB CE FF E1 88 56 1A EB AE BD 38 29 80 0E 12 42 94 74 09 21 40 C2 65 14 01 E8 81 64 76 FA EC 9F FE F7 53 23 1A 16 A4 C8 1C 82 80 85 85 98 55 3C 58 69 A1 7C 4C 11 A6 6C 8A 1E 58 46 C7 A6 1E 7A 65 E1 B7 46 74 87 71 81 08 41 74 D1 B1 84 92 B9 65 28 20 0E 0C 4D 3A EA 40 2B 1F 68 46 E7 A6 6E B9 F1 E1 F3 47 74 E8 10 6B EF DC 5F E3 49 16 51 43 02 4B 83 B8 E4 66 D1 74 81 1E 78 46 07 A7 2E 6A 3F 78 78 44 3B AF D1 15 03 44 B7 40 70 F1 E0 00 E9 35 1A C6 26 A1 75 D5 0A F4 40 34 3A 39 F5 EB F3 97 7C 79 44 43 45 50 95 DA 43 B8 D1 69 75 0E AE 18 85 3D 57 A8 4E 85 A3 04 7A 60 DA 16 84 BE FC C0 85 CF B3 5D 6B AA 8B AC 54 03 BB 4D 94 0A 1B 8E 9D 97 2D 54 6F 91 EE 34 D0 03 D5 B6 24 F4 5A 07 AD BB 90 9D 58 41 A3 ED 46 2B F8 67 58 84 14 90 B4 D0 41 E0 7E 85 87 4D 49 40 0F 5C DB 8A D0 F2 B2 CD 2E 64 CF 8E B6 6A 01 F3 57 7C 46 EF 40 D2 80 C3 40 CF D0 10 71 89 5F 89 B6 36 70 6D 6B 42 AF 7C FC 09 0F 8D 68 94 A4 A5 87 E5 0A F1 37 BD C5 0E 93 23 2A 62 9E A4 96 4D E8 81 6B EF 20 F4 71 FB 98 CD D8 CA 2B 5E D4 06 6F 33 F4 0C 41 2B C5 5A 7A 69 C6 15 01 F3 60 71 62 33 DB FF 4E 42 DF 79 D6 83 47 B1 67 77 4B 80 04 A7 0D A2 66 6C A0 49 28 54 DA 0E 88 A9 EA 40 0F 5C DB 86 D0 EF 7F 7C 8B 3D 19 5B 0C 76 AB 20 63 34 58 50 54 08 0E 1F D6 0C CB CE 36 C0 E5 18 A0 07 AE 6D 4B E8 79 DB AE F6 2C 63 4B 80 F0 56 AF 11 16 B4 11 CD 05 0F 5B 57 65 13 D9 55 1B E1 E9 E4 CC F9 6F 37 AD F1 47 37 AB AC 42 4D CB C8 F1 19 B1 B6 9B A8 E1 92 72 C5 6E 51 1F 42 07 CC B4 F2 81 6B EF 22 F4 1A AF 5F F6 B7 23 5A 40 B9 34 0C 4A 30 BD 9A 04 55 47 24 8D D1 09 84 EC 0C A5 A5 3D 1F B8 F6 6E 42 BF 73 DB C5 AB B3 F3 4E 12 3C B5 2D A1 DD C0 D4 94 24 A5 B1 4D A2 71 C1 A5 34 0B 9E CF CC FF 02 42 2F EA CF B1 5D 4B 21 99 96 70 C0 02 04 CF D1 E4 D0 E0 79 62 41 4E 0D D4 1C 80 1E B8 F6 1E 42 BF ED C0 89 64 BA 56 A0 9E 42 EB D8 D0 6F 61 AA C0 1C 0D 7B 2A AB 34 0A 4D 09 E7 3D B3 FF EF 25 74 D9 F9 2F 6B 8F 68 68 3F 84 01 CD C7 A1 75 42 FF 93 D7 E8 5E 12 51 5B 81 B3 35 03 3D 70 ED 7D 84 BE EA 8E 15 1E 64 BB 06 0D 69 38 AB 50 E0 B2 B2 4C 70 64 32 89 AE 9B 0E 48 AD 06 7B 3E 0B 00 DB 13 DA 3E B6 EA AF D9 79 CB A9 FC 36 09 EF 8C CE 0D 66 A3 DC 48 A2 E0 D5 E0 CE B0 E7 B3 04 B0 03 A1 F7 FD D8 1F 8F 66 5C 53 48 27 D4 EB 2A 34 15 A6 12 5C C5 FA 4B 47 F1 38 2D 22 F6 7C 16 01 DE 4F E8 55 CF FE CA 7A 8C 2D 08 0B 8D 32 8F 95 0A 3D 0C 3E BA 3B 19 BA 75 30 AA D1 C1 A0 C9 59 06 F8 00 A1 EF 5F F0 D0 A6 5C 91 85 17 48 2E 49 A3 97 04 18 26 2B 80 6B BD DB 4A D9 45 00 3D 70 6D 47 42 7F 73 F1 72 5B B0 95 97 58 75 2B 59 21 9A C3 21 E5 84 03 43 70 80 4E E3 D1 D8 04 A0 07 AE ED 44 E8 FA D4 3E F7 8C E8 6A 5D 0E 38 D3 86 3D 42 82 80 27 06 CE 4E 2D 44 49 C5 D1 AE 0D 5C DB 99 D0 97 FD E8 E0 6B FF 46 D7 B4 72 28 32 5F 04 1C 92 4E 95 F2 31 FC 5E 70 CD C1 B0 02 3D 70 6D 17 42 7F FB 86 E3 4E 67 BD C4 0A AC 5C 20 F4 19 78 62 AC 23 68 D9 1B CC 39 7A A8 46 43 9E C8 59 10 D8 95 D0 3F 5F EF D6 6D 19 DA 3B B8 58 01 25 40 37 40 4A 04 75 5C EF 21 63 3B 3A 7C 0C D4 61 96 04 76 23 F4 6D BF 3A 7D F4 A6 F3 0D 3A 37 6C A8 43 6C CB 08 AA 35 BA AE 40 20 68 24 E2 2F C8 0B F4 C0 B5 DD 09 FD E0 83 3B 88 11 DD BA EF 22 15 01 AB 00 79 2D 0A 86 CD A7 66 3D 7A A0 4B 36 3A A0 07 AE ED 41 E8 0B 56 7F F9 7E DE BF 4D CE 0D 6D 08 E9 C5 80 70 31 C1 6F 21 B3 C7 56 68 21 A8 D0 59 18 58 48 E8 DD D6 7D CD 69 EC BD 13 72 17 84 10 7E C1 18 E1 91 FA 92 0A A8 4F 4F 57 8C 48 F9 40 0F 5C FB 20 A1 77 7A EB F5 13 76 DE 0E D1 94 DE 17 02 67 54 0E B9 21 43 A0 83 E2 F8 1A 5D 4D 00 3D 70 6D CF 29 D7 D6 0F CB 31 B4 57 A5 A5 AA 5C 8F 74 AD 09 B6 C5 58 48 A7 54 A7 64 45 E8 81 6B 1F 22 F4 BD 73 B6 59 C4 DE 9B EE 22 5B C5 A6 19 8B 30 51 43 A1 36 DA 0C 62 64 0A 38 70 A0 07 AE 7D 98 D0 C7 CD DD F8 26 F6 6C 81 B3 E9 D4 F6 D0 05 61 89 B1 75 3D 78 5D 90 A4 14 94 1D 55 32 4B 04 1F 21 F4 43 5B 6E 77 20 AB 92 E8 D1 3D 91 99 34 D2 2E DC 0E 12 73 26 B6 49 64 19 D3 A8 97 CC 22 C1 47 09 BD CD 95 2F DD C8 FA 98 94 16 D6 45 35 EF 21 27 1E D6 C3 38 B0 16 DD B8 A1 3B 39 AC 7C 96 09 3E 46 E8 17 E6 EE F5 3E DE 0D BA A5 2B 89 8C D8 84 93 F7 D1 F7 1A C0 1F 64 CF 84 E8 09 6D 99 85 82 BD 08 BD CC A6 AB DD C5 9E 8D D6 9D 93 F5 38 29 EC 1B 4E 4E 25 BA 08 22 DF A5 82 0E E8 63 B3 54 B0 37 A1 0F BA F0 1A 76 62 1D C6 4E 08 65 D0 2A 25 5D 46 25 27 9C 4D 4A 76 B8 5F FA 0B E8 81 6B 1F 27 F4 82 4F 7F E6 9B 6C E5 25 C2 5B 52 BC CD 15 27 86 7F 42 26 D1 1B BC 6A 30 DE 15 2E 77 96 0B F6 21 F4 93 BF BE E2 14 D6 89 9A A5 57 CD 48 EC 11 FE 36 C0 5E 96 2A E8 F4 20 1B 95 F4 7C 16 0C 12 A1 0F BE 3D 3C C1 F4 1C E9 0D FE 18 1D 04 BD 1F AE 3E 41 4D A3 CF 38 30 78 CE DA E9 C4 06 AE 65 42 CF 5D B0 E6 15 EC BC 41 4E 67 AA 11 78 B2 C1 5B 04 72 5F C5 43 51 A3 16 69 8A 1E B8 56 08 ED 7F F8 E2 DE AC 0B C2 9D 48 01 8E 68 D4 2A A4 29 CA 4A C5 DD A5 47 32 83 75 03 7A E0 1A 3C C3 1C 79 CD 8E 3F BF 9C 5F 82 89 04 8B F2 D7 7B AC 4E D7 32 C8 37 4D 27 D8 5C 6B A2 65 53 80 46 E0 9D 0F DC E2 75 EC 8E 36 8B 12 72 94 10 71 18 AE 98 51 DC 01 FB 08 C6 6B 54 BC 97 E3 14 A0 13 78 D9 AB CF DC 8A DD 26 65 48 BE 91 9A EC BD A9 C9 05 BC 74 13 3D 09 14 79 6C 52 8E 53 80 4F 10 F8 E8 77 3D C7 86 17 8E EE D1 7D 73 C8 AC 1A 44 6B B9 48 81 2C 22 E8 96 B4 C0 85 8C 53 80 4F 12 78 FB AD FF C4 2E F2 3B B8 08 25 84 A2 C1 F1 E8 8E 18 0C 51 17 BE A0 38 15 D8 67 C6 29 C0 A7 08 BC F9 55 BF 5B 9E 25 31 F8 12 14 98 4B A1 24 53 12 3C 5E 2C D4 51 D0 BC 51 E3 C6 8D 53 80 7D 09 2C EE 5B EE 28 B6 DB C8 E5 A0 4A C3 9E 61 C3 E1 74 52 6E CD 61 EF E8 06 4D 65 39 4E 01 F6 23 F0 4B 3F 5B FB 19 76 6B A8 0D D9 44 8B 4C 42 07 0D 11 84 63 A5 57 87 41 14 38 B9 71 0A B0 88 C0 87 5E F9 E4 0F D8 86 45 E5 24 56 0D 39 45 06 84 5D D0 12 32 5A 5A E8 45 38 C4 D7 71 0A B0 98 C0 EB 3D F2 C1 C5 2C 71 5B EB E9 E6 1B 29 02 CD 0B 4A E2 0C 55 0B 8D 7A 32 E2 A1 1B A7 00 FB 4F 77 FB BA 43 58 74 85 C4 8B A4 BC 6F 11 56 09 08 04 ED D2 3A FE 03 55 CB E8 AA E3 14 E0 00 02 FF 76 DE 11 8D 5D 14 C0 A0 24 A4 01 D2 04 C4 89 9E 2D FE 87 55 D1 3B 81 1C D7 E4 38 05 F8 F4 F4 A8 CE 38 98 DD 4B 23 E8 25 8D BA 40 E0 15 70 59 9A 88 2A F1 CB 28 13 C4 E2 DC 38 05 38 90 C0 4B AE D8 EE 57 8C 24 88 11 48 AB 48 CB 1D ED 2F 06 54 26 AC 8D 09 01 5B E1 14 1A DF 2C 0D 1C 44 E0 45 3F 3B 90 CD 5C AC F2 2E 35 25 B2 75 12 24 31 B1 DA 0E 39 AD A2 56 98 C4 5C C6 29 C0 67 08 7C D5 FE AB 3D CC 0A 83 86 23 52 F7 5E 13 4C 31 E8 E6 21 C7 50 36 38 15 8B DF 2A C7 29 C0 67 09 7C F1 6F D3 F9 0C 4C 29 11 CF 71 C9 37 E8 38 92 76 EB 02 1B 8D BF 1A 14 5C 8C 53 80 83 09 FC 84 98 BB 3A 17 03 AB 75 6E E0 B7 AB D8 ED 42 F7 03 1D 09 18 A7 67 8C AC 7A 9C 02 1C 42 E0 83 D6 3C F3 34 FE E4 5A D0 9D F1 E6 64 89 25 19 79 78 03 A4 F5 5C 2A 8E C0 8C 53 80 43 09 FC AD 8D 9E BD 94 DF 63 49 14 40 C5 C6 42 72 95 50 11 99 0B E6 B4 A6 84 74 82 F6 3B 4E 01 0E 23 F0 7B F3 7F DD C2 4A 12 F6 1B 95 01 F7 9B A4 49 D3 46 25 24 8C 5E 6A A8 6F 07 57 39 8B 01 87 13 F8 F6 BB FE 70 24 3B 67 89 74 A4 12 B4 C8 22 29 5A 85 0A 81 39 06 CB 5B 70 52 75 35 4E 01 8E 20 F0 26 B7 9E CC 8E AA 58 47 D1 C3 25 88 09 14 A5 47 A7 55 A8 CE A1 7F 2B EB 5B 1A A7 00 9F 23 70 38 EC 61 CB 0A 83 C6 33 D8 24 53 28 30 D8 8E DD 87 A8 35 04 47 18 52 AC 68 9C 02 7C 9E C0 EE A3 BB F0 1B 71 9C 50 EA 8E DC 74 33 29 17 98 F8 0A 6F 81 2D 14 25 87 C2 A6 00 47 12 F8 96 77 FF F2 1E 26 06 88 69 CA 78 C4 3C BA C8 47 10 E9 A1 C0 BC 7B 90 14 65 E9 D9 14 E0 28 02 DF 77 CD 05 1B 31 92 68 3C C6 76 78 13 8B F0 A6 75 E8 A4 A0 28 16 0D 53 1F 34 9B 02 7C 81 C0 27 2C D8 EC 70 7E D9 89 8C 9E 10 D8 02 CC 48 D7 30 71 58 36 79 8E 84 43 80 18 8D 53 80 A3 09 7C C9 BA FB EE C4 18 86 A4 00 91 F5 C8 78 7D EA 89 8D D2 D5 C2 9A 44 DD 20 C7 6D 9C 02 7C 91 C0 E7 DE F9 A9 FD 38 18 3F 1F 8B 48 55 58 64 4E E4 BD 8E 12 6F 32 D2 58 D2 A1 DD CC DC FF 31 04 9E 17 3F BC 22 BB 5A 0E 74 FD 63 9C 30 78 E7 20 3B EC A4 8D 9A 26 C9 B5 E0 E5 F3 38 05 38 96 C0 3B 3C 7F CC FB 99 86 E9 A0 A1 BE B9 07 88 88 81 E4 A2 C7 0A 64 EC 26 4A 03 73 DB 38 05 F8 12 81 7F B1 36 07 A3 B3 0A A4 45 EB 71 AA 06 14 41 48 6E 50 97 4C 11 B0 1B BA 8B 1F 18 F6 8F 04 5E 66 AD C9 9B 19 49 3C D4 B2 D2 39 C3 81 7A A4 EB 80 06 27 53 50 D9 42 57 43 1D A7 00 C7 11 78 E1 7D 97 8D 77 31 93 16 3C 79 09 E4 54 D7 E9 A6 14 69 CB 69 67 7C A2 29 99 D5 6E 9C 02 7C 99 C0 CF AF F2 A7 D1 4E 4D 62 49 34 20 D7 32 15 6F E8 4B 03 38 83 2E 61 A5 A2 87 3F 40 B0 9F F9 FE E3 09 1C B7 BA F6 32 56 55 DA 44 54 45 80 ED E9 A0 A5 09 90 2F B4 F6 6E 8C A6 D1 AF 18 A7 00 27 4C 8F EA 90 CE 48 A2 32 02 0E AC A6 76 B0 30 92 9C 6B 85 3B 33 B6 C2 68 60 13 FD 38 05 38 91 C0 8B AE 3D F1 45 A6 DB 54 45 38 EA 28 A6 F3 1A 07 6E 07 B8 02 A3 68 02 91 75 1D A7 00 27 11 F8 86 FE 14 7B B2 90 4E 68 0B 1D B1 D0 2E A8 16 9C 9B 35 29 40 17 41 F5 28 E2 38 05 F8 0A 81 9F BD F9 A2 B7 F0 4B 6D 55 70 54 28 07 59 E1 3F 51 0F 74 9D E1 9B 85 FC F6 22 D3 38 05 38 99 C0 1B BE B2 31 1B 9B 28 9B 52 91 4A A3 9F 76 E3 02 4D 4D 2A 56 2E 3A DD 09 45 28 C9 CC F1 7F 95 C0 FA F8 13 59 3D 3B 6B 3B 44 A8 16 F0 09 F4 44 1E 07 5B A9 DD DB E9 1D 0E 9B 02 7C 8D C0 8B 8F 3A 72 C2 96 1D 1C 54 37 38 AF 1B B4 DE FA 44 EA DF 20 26 94 B8 10 61 C6 29 C0 29 04 7E F9 81 77 68 5E 55 06 0B 2D 06 21 03 DC 8E 11 AC 52 21 79 58 38 2C BA 74 3B 4E 01 4E 25 F0 35 AB 7F 91 3B 83 84 24 A4 9C 82 5F AD F0 AE 21 F8 0C A7 0D F9 2A 80 43 15 C7 29 C0 69 04 BE F5 9E BF B0 69 0F 68 89 7C 14 5D CD 38 2A EC 59 42 A2 CD B0 44 38 25 89 63 66 53 80 AF 13 78 DF 0F 9C CD 06 36 F0 F3 38 64 A8 15 E5 3A 03 E9 01 63 02 2C 9D 83 77 15 70 92 E3 14 E0 74 02 3F FD E6 39 7F E0 B3 35 57 91 49 AC 24 E9 B5 A1 E2 D5 33 04 34 F7 44 99 18 0C 9B 59 FD 33 08 7C 4F D9 6F 17 26 BD 88 AF C9 15 18 38 AC 61 3A 02 80 BB D1 A9 34 54 27 36 53 8C 53 80 33 E7 50 B2 FB E8 E3 8F B3 7C 64 A1 3C 2E 78 45 32 06 11 CD 38 75 C4 54 3C 1B 8D 63 9A AE 66 56 FF 1B 84 7E F1 80 B9 FB B0 3B 08 EB BC 2F 34 E7 A1 E9 05 7D D6 50 E8 C8 6C 91 55 E5 98 F9 14 E0 2C 42 6F F4 FC 0D A3 07 9C 0F C7 84 2D 02 B5 D1 A8 8C 45 BC B0 19 45 5E 7C B0 88 79 68 3B 6C 0A 70 F6 14 BD D2 DB 47 3D 98 DF 94 0D A1 E0 5C D1 7A 4C F2 11 0E 41 A1 E5 D1 A5 0F CA 4D 64 36 05 38 87 D0 27 6C BB 07 9B 02 48 38 F6 DC 05 DD 25 14 14 35 92 51 E9 70 A3 0E CB 08 11 BF 94 4D 01 BE 49 E8 63 6F DB 6F 37 B6 F2 EC 84 2D 4A D0 80 CB 68 97 33 7D D9 41 DF B1 C0 23 80 BE 95 4D 01 CE 9D EE F9 11 6B DF C8 D1 26 A0 AB 55 F2 FC 06 CE 06 E5 11 A7 5F 2D 05 B8 69 E7 04 9B 02 9C 47 E8 3D 0E 59 65 01 43 07 DD 1B BC 2B 7D A1 80 6E 9D 72 14 24 07 C2 82 E6 D6 07 C5 A6 00 E7 13 FA 37 F7 BE 3A 4E 71 E7 E3 41 D0 BE 80 58 12 0B 5C 51 84 A4 56 BA 1D 14 22 E0 BF 74 53 37 B3 FC DF 22 F4 2D 8F EE F2 7B 96 49 61 75 33 1C 10 CE 0C ED 32 A0 3A E0 2C 7A 81 00 37 1D 93 E5 53 80 6F 13 7A D9 FF BC 80 E5 61 10 AA 15 BA 36 82 9B C0 B3 55 80 DB 48 D8 70 72 38 F0 65 9D 4D 01 2E 20 F4 23 97 9E FB 8D 11 ED 85 C6 1F E4 5A 18 4A 1A 4F 06 EA F6 E0 3B 28 84 8E 14 05 9B 02 7C 87 D0 0F AC 96 2E 65 BB 26 48 55 40 92 84 62 9C 86 58 2F 50 70 22 4B 23 55 6D 82 4D 01 2E 24 F4 F7 CE B8 FF 54 CE 73 03 9E 76 8F E4 4C E6 BB 82 77 4D 24 FA 66 88 42 90 15 6C 0A 70 11 A1 CF D9 F0 8A 07 F8 4D 5D 92 5D C1 BA D3 39 35 8B EE EE 0B 7E 85 46 94 CF 38 C3 CA A6 00 17 13 7A 99 F5 DF 7D 10 BB 45 40 A8 A5 6B 5D 53 E9 66 19 D1 47 53 1F D3 A1 20 4A 7B 28 16 9B 02 FC 13 A1 FF 7C D6 1D AB B0 F7 6E C2 77 44 1B 08 A0 A7 2F B4 E0 F8 35 44 34 40 97 68 54 C7 A7 00 FF 4C E8 47 37 D8 6D 1B 76 DF 05 D3 8D 6A 9A BA 32 43 46 8E A4 B0 97 88 D0 03 71 F5 9D 4D 01 2E 21 F4 95 1F 5F EE 6C F6 6C 8B E7 C9 9C 60 8D B4 69 A5 64 F8 EF 1A 9A 2C 30 96 20 A0 63 53 80 4B 09 7D 8D DF 7C 45 56 DF B0 A3 20 A5 42 E0 71 D4 BE 32 DA 00 A2 9E 0B D8 37 F8 60 CD A6 00 DF 25 F4 21 77 AC 33 1A BB F9 30 63 C6 93 79 AD 01 45 0A 97 57 4D 57 30 E4 38 B1 44 5F 4F B0 29 C0 65 84 BE 7B E1 F6 CF 31 34 DD 54 C4 EE 6C 0C DA 64 E9 A3 40 17 C0 F3 BD 40 42 D4 2E B1 29 C0 E5 84 5E F9 B9 F3 7F CC AA 04 39 34 66 01 6E C2 5C 76 44 72 98 3C E4 C4 06 EF D0 03 0C 07 9B 02 5C 41 E8 D3 5E 7C 65 27 56 25 B1 23 7D 58 9A 02 A0 0B 05 84 F3 5A 0B 7A B6 A7 5B 14 95 2A 9B 02 5C 39 AD D0 33 3E E9 46 74 71 05 66 AA A7 EE C9 96 76 DA 2D 8B 14 11 F1 BA 50 F9 AA D9 14 E0 7B 84 5E F5 DC 0D D8 FD 26 2C 46 F7 1D 61 D6 52 A4 A7 C1 3F DD 6F 16 83 36 DA 91 AB 35 9B 02 FC 0B A1 8F F9 FC 92 C7 F8 04 22 80 59 9A BC 9D 35 2A E7 84 D6 A2 3B 8E 11 8E 2B 74 65 D9 14 E0 FB 84 2E 87 2E 3F 7E 22 32 BF 96 06 05 E9 D1 4B 9B E9 C3 0E BA 23 93 A8 55 91 B0 1A 30 88 4D 01 7E 40 E8 1D F7 DC 67 01 D7 73 57 2D 1A 56 B5 22 19 9C 71 EE 48 D7 70 E3 D6 0A 8D 57 8F 6C 0A 70 15 A1 57 7B 62 C3 EB 18 DA D2 4C 18 09 26 81 27 E8 E2 B9 83 3B F0 F0 96 82 88 33 7C 0A 70 35 A1 EF FD CB 31 DF 61 4C 45 BC 26 6E 0B FA 7A 27 04 1D AA 8E 12 5D 09 6D 10 14 F6 96 4D 01 AE 21 F4 29 8F CC FB 25 7B 6F ED 9B 97 05 85 A5 32 BC 3C 3C 8E 94 A8 D4 E2 1C 62 6E 55 7C 0A F0 AF D3 5D 7B E1 42 76 43 09 7F 82 6E DF 60 EA 34 DD C0 58 9A 47 5B A4 19 FA B4 26 56 BA E7 9B 45 81 6B 09 7D E2 5E 74 B5 3C E3 B9 CC D8 DA 48 83 74 69 68 D8 D6 22 BC 93 C1 39 64 25 85 B0 6C 0A F0 43 42 FF E6 D8 67 56 65 DE 41 79 10 43 19 EC 16 AA CB 23 FA D5 4E 73 51 B8 2E F8 FC A0 D9 14 E0 DF 08 FD EA AE BB B2 09 44 72 D0 53 85 56 40 E3 BE 00 C3 81 18 A6 3A E2 17 7D EF 86 D3 62 53 80 EB 08 BD E0 FA BB 0C 9B 38 65 EC 77 A7 2F 3B AA 31 4D 21 86 C0 EC 42 2A 11 4B D0 06 5B 67 53 80 EB 09 FD CC 73 8F EF C0 AA 44 68 38 FF AC 1A 5D 8E C6 4C BE 25 69 0F CE 09 BC 42 A2 59 D9 2C 0F FC 88 D0 37 6F 75 31 9B 11 C2 DB E0 2D 51 60 99 F2 7D 68 F4 0D AF C8 A2 C5 28 5C 69 D3 F9 C5 C0 B5 7F 27 F4 1F 3F BC E3 4F B8 2A 7A 38 62 4B 77 3F CA 14 8A BD 1D 26 40 21 12 E0 B7 34 AA 92 59 22 F8 31 A1 B7 3A FC 3C F6 DD 05 E8 51 C9 51 BA 4E 53 A6 08 66 E9 2C 1B 72 0C 12 5C AB 34 59 9D 45 82 1B 08 7D D7 1E 77 BF 81 F5 92 E2 55 C8 15 C5 E8 A2 D1 45 E7 02 CA 63 CF B1 87 3E 8B 62 D9 14 E0 46 42 1F B9 C2 F2 8C 6B 70 86 E8 00 3D E6 D2 E8 BA 0D EA 9E C8 34 54 FA 6A C5 4C 67 C2 B3 50 70 13 A1 ED C6 67 5C C2 7A 49 46 68 8A A6 4E 15 D9 57 99 1C 7D A5 43 1F 85 81 05 86 A6 7C B3 54 70 33 A1 1F BF 67 77 36 D5 C5 C2 1D EA 92 C6 B9 01 71 D7 C2 C7 D4 22 E9 73 02 D5 C8 24 B3 29 C0 2D 84 3E EA A5 B5 BE CA CF DB DA A0 A0 23 28 D3 E9 B0 06 87 25 25 A5 5F 01 BF 46 DF 7C CC 72 C1 12 42 CF BB E1 BA E3 59 8D C1 26 08 67 92 A3 A3 D2 46 45 B8 EB 84 23 B4 42 52 18 B4 6C 0A 70 2B A1 AF 5A E5 8E 35 D8 B3 E1 F2 14 B8 1C 1B 22 49 17 85 3E AF F7 F0 3F 3D A1 B8 7A E0 53 80 DB 08 FD 8E BD 76 7E 98 F1 9C C6 F5 05 4D BA 55 EA A1 11 8D 04 A6 89 EA 1B 3D 35 D2 2C 7C 16 0D 7E 42 E8 45 7B 6F BA 32 43 43 C1 AB 6E 0D AE 18 C6 14 26 39 59 27 75 87 B0 22 F5 57 47 BB 16 FF 1F 9A 15 EE 1B 0C 30 00 00 ]"
                .Split(new[] { '[', ' ', ']' }, StringSplitOptions.RemoveEmptyEntries)
                .Select(x => Byte.Parse(x, NumberStyles.HexNumber)).ToArray();
            var resp = Response.DeserializeFrom(new MemoryStream(bf), ApiKey.FetchRequest); 
        }

        static void SendMessage() {
            var producer = new ThrottledProducer(option);
            var list = Enumerable.Range(0, 1000).Select(x => $"{Guid.NewGuid().ToString("n")}#{x}");
            producer.Send("demoTopic2", list.ToArray());
            using (producer as IDisposable) { };
        }

        static void StartConsume(CancellationToken token) {
            var consumer = new Consumer(option, "demoGroupId", "demoTopic3");
            consumer.Initialize();

            foreach (var msg in consumer.Fetch(token)) {
                //Console.WriteLine(msg);
            };
        }
    }
}
